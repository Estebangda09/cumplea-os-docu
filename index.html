<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>隆Cumplea帽os del Mes!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Decorative elements */
        .decoration {
            position: absolute;
            opacity: 0.1;
            pointer-events: none;
            animation: float 6s ease-in-out infinite;
        }
        
        .decoration:nth-child(1) {
            top: 10%;
            left: 10%;
            width: 20px;
            height: 20px;
            background: #ff6b6b;
            border-radius: 50%;
            animation-delay: 0s;
        }
        
        .decoration:nth-child(2) {
            top: 20%;
            right: 15%;
            width: 15px;
            height: 15px;
            background: #4ecdc4;
            border-radius: 50%;
            animation-delay: 2s;
        }
        
        .decoration:nth-child(3) {
            bottom: 30%;
            left: 5%;
            width: 25px;
            height: 25px;
            background: #45b7d1;
            border-radius: 50%;
            animation-delay: 4s;
        }
        
        .decoration:nth-child(4) {
            bottom: 10%;
            right: 10%;
            width: 18px;
            height: 18px;
            background: #f9ca24;
            border-radius: 50%;
            animation-delay: 1s;
        }
        
        .decoration:nth-child(5) {
            top: 50%;
            right: 5%;
            width: 22px;
            height: 22px;
            background: #6c5ce7;
            border-radius: 50%;
            animation-delay: 3s;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: slideInFromTop 1s ease-out;
        }
        
        .title {
            font-family: 'Fredoka One', cursive;
            font-size: clamp(2.5rem, 6vw, 4rem);
            color: #ffffff;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            line-height: 1.2;
        }
        
        .month-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.95);
            color: #d63384;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.8rem;
            font-weight: 700;
            border: 3px solid #d63384;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .birthdays-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .birthday-card {
            background: linear-gradient(135deg, #d63384 0%, #dc3545 100%);
            border-radius: 20px;
            padding: 25px;
            color: white;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transform: translateY(20px);
            opacity: 0;
            animation: slideInFromBottom 0.8s ease-out forwards;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .birthday-card:nth-child(1) { animation-delay: 0.1s; }
        .birthday-card:nth-child(2) { animation-delay: 0.2s; }
        .birthday-card:nth-child(3) { animation-delay: 0.3s; }
        .birthday-card:nth-child(4) { animation-delay: 0.4s; }
        .birthday-card:nth-child(5) { animation-delay: 0.5s; }
        .birthday-card:nth-child(6) { animation-delay: 0.6s; }
        .birthday-card:nth-child(7) { animation-delay: 0.7s; }
        .birthday-card:nth-child(8) { animation-delay: 0.8s; }
        
        .birthday-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }
        
        .birthday-card.highlight {
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
            animation: celebrate 2s ease-in-out infinite;
        }
        
        @keyframes celebrate {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        
        .birthday-card::before {
            content: '';
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5rem;
            opacity: 0.3;
        }
        
        .birthday-date {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            background: rgba(255,255,255,0.2);
            padding: 8px 15px;
            border-radius: 15px;
            display: inline-block;
        }
        
        .birthday-name {
            font-size: 1.4rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .no-birthdays {
            text-align: center;
            padding: 60px 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            animation: slideInFromBottom 0.8s ease-out;
        }
        
        .no-birthdays-emoji {
            font-size: 4rem;
            margin-bottom: 20px;
            display: block;
        }
        
        .no-birthdays-text {
            font-size: 1.5rem;
            color: #ffffff;
            font-weight: 600;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .footer-text {
            color: #ffffff;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .update-time {
            color: rgba(255,255,255,0.8);
            font-size: 0.8rem;
        }
        
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #ffffff;
            font-size: 1.5rem;
            font-weight: 600;
        }
        
        .loading::after {
            content: '...';
            animation: dots 1.5s infinite;
        }
        
        @keyframes dots {
            0% { content: ''; }
            25% { content: '.'; }
            50% { content: '..'; }
            75% { content: '...'; }
            100% { content: ''; }
        }
        
        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideInFromBottom {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .birthdays-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .birthday-card {
                padding: 20px;
            }
            
            .month-badge {
                padding: 12px 25px;
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Decorative elements -->
    <div class="decoration"></div>
    <div class="decoration"></div>
    <div class="decoration"></div>
    <div class="decoration"></div>
    <div class="decoration"></div>

    <div class="container">
        <div class="header">
            <h1 class="title">隆CUMPLEAOS DEL MES!</h1>
            <div class="month-badge" id="monthBadge">JULIO</div>
        </div>

        <div id="birthdaysContainer">
            <div class="loading">CARGANDO</div>
        </div>

        <div class="footer">
            <div class="footer-text"> Datos actualizados autom谩ticamente</div>
            <div class="footer-text">Los cumplea帽os se cargan directamente desde Google Sheets de Docuprint.</div>
            <div class="update-time" id="updateTime">ltima actualizaci贸n: --</div>
        </div>
    </div>

    <script>
        // Datos de respaldo con los cumplea帽os actuales
        const fallbackData = [
            { fecha: '01-07', nombre: 'Karen Rojas' },
            { fecha: '04-07', nombre: 'Federico Menoyo' },
            { fecha: '08-07', nombre: 'Euge Lozano' },
            { fecha: '13-07', nombre: 'Jorge Leal' },
            { fecha: '17-07', nombre: 'Nelson Solorzano' },
            { fecha: '20-07', nombre: 'Analia Antonio' },
            { fecha: '26-07', nombre: 'Juan Roman' },
            { fecha: '27-07', nombre: 'Carolina Espinola' }
        ];

        // Configuraci贸n
        const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/19I-TH5n50H_HSEuANIo2qvSbV30ayiynKEpCWN3lZI4/export?format=csv&gid=0';
        const TIMEOUT_DURATION = 10000; // 10 segundos

        // Funci贸n para obtener el mes actual
        function getCurrentMonth() {
            const months = [
                'ENERO', 'FEBRERO', 'MARZO', 'ABRIL', 'MAYO', 'JUNIO',
                'JULIO', 'AGOSTO', 'SEPTIEMBRE', 'OCTUBRE', 'NOVIEMBRE', 'DICIEMBRE'
            ];
            return months[new Date().getMonth()];
        }

        // Funci贸n para obtener el n煤mero del mes actual
        function getCurrentMonthNumber() {
            return new Date().getMonth() + 1; // +1 porque getMonth() devuelve 0-11
        }

        // Funci贸n para parsear CSV
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const data = [];
            
            // Saltamos la primera l铆nea (headers)
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line) {
                    const columns = line.split(',');
                    if (columns.length >= 2) {
                        const fecha = columns[0].trim().replace(/"/g, '');
                        const nombre = columns[1].trim().replace(/"/g, '');
                        if (fecha && nombre) {
                            data.push({ fecha, nombre });
                        }
                    }
                }
            }
            return data;
        }

        // Funci贸n para filtrar cumplea帽os del mes actual
        function filterCurrentMonthBirthdays(data) {
            const currentMonth = getCurrentMonthNumber();
            const currentMonthStr = currentMonth.toString().padStart(2, '0');
            
            return data.filter(birthday => {
                const [day, month] = birthday.fecha.split('-');
                return month === currentMonthStr;
            });
        }

        // Funci贸n para verificar si es el cumplea帽os de hoy
        function isToday(dateStr) {
            const today = new Date();
            const [day, month] = dateStr.split('-');
            const todayDay = today.getDate().toString().padStart(2, '0');
            const todayMonth = (today.getMonth() + 1).toString().padStart(2, '0');
            
            return day === todayDay && month === todayMonth;
        }

        // Funci贸n para mostrar los cumplea帽os
        function displayBirthdays(birthdays) {
            const container = document.getElementById('birthdaysContainer');
            
            if (birthdays.length === 0) {
                container.innerHTML = `
                    <div class="no-birthdays">
                        <span class="no-birthdays-emoji"></span>
                        <div class="no-birthdays-text">No hay cumplea帽os este mes</div>
                    </div>
                `;
                return;
            }

            // Ordenar por fecha
            birthdays.sort((a, b) => {
                const [dayA] = a.fecha.split('-').map(Number);
                const [dayB] = b.fecha.split('-').map(Number);
                return dayA - dayB;
            });

            const birthdayCards = birthdays.map(birthday => {
                const isHighlight = isToday(birthday.fecha);
                const [day] = birthday.fecha.split('-');
                
                return `
                    <div class="birthday-card ${isHighlight ? 'highlight' : ''}">
                        <div class="birthday-date">${day}-07</div>
                        <div class="birthday-name">${birthday.nombre}</div>
                    </div>
                `;
            }).join('');

            container.innerHTML = `<div class="birthdays-grid">${birthdayCards}</div>`;
        }

        // Funci贸n para cargar datos desde Google Sheets con timeout
        async function loadBirthdaysFromGoogleSheets() {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), TIMEOUT_DURATION);

                const response = await fetch(GOOGLE_SHEET_URL, {
                    signal: controller.signal,
                    mode: 'cors',
                    headers: {
                        'Accept': 'text/csv',
                    }
                });

                clearTimeout(timeoutId);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const csvText = await response.text();
                const allData = parseCSV(csvText);
                const currentMonthBirthdays = filterCurrentMonthBirthdays(allData);
                
                return currentMonthBirthdays;
            } catch (error) {
                console.error('Error loading from Google Sheets:', error);
                throw error;
            }
        }

        // Funci贸n para cargar datos con fallback
        async function loadBirthdays() {
            try {
                console.log('Intentando cargar desde Google Sheets...');
                const birthdays = await loadBirthdaysFromGoogleSheets();
                console.log('Datos cargados exitosamente desde Google Sheets');
                
                // Actualizar tiempo de actualizaci贸n
                const now = new Date();
                document.getElementById('updateTime').textContent = 
                    `ltima actualizaci贸n: ${now.toLocaleString('es-ES')}`;
                
                return birthdays;
            } catch (error) {
                console.log('Error cargando desde Google Sheets, usando datos de respaldo...');
                
                // Usar datos de respaldo
                const currentMonthBirthdays = filterCurrentMonthBirthdays(fallbackData);
                
                // Actualizar tiempo de actualizaci贸n
                document.getElementById('updateTime').textContent = 
                    `Usando datos de respaldo - ${new Date().toLocaleString('es-ES')}`;
                
                return currentMonthBirthdays;
            }
        }

        // Funci贸n principal
        async function init() {
            // Actualizar el mes actual
            document.getElementById('monthBadge').textContent = getCurrentMonth();
            
            // Cargar y mostrar cumplea帽os
            const birthdays = await loadBirthdays();
            displayBirthdays(birthdays);
        }

        // Inicializar cuando se carga la p谩gina
        document.addEventListener('DOMContentLoaded', init);

        // Opcional: Recargar datos cada 30 minutos
        setInterval(async () => {
            try {
                const birthdays = await loadBirthdays();
                displayBirthdays(birthdays);
            } catch (error) {
                console.error('Error en recarga autom谩tica:', error);
            }
        }, 30 * 60 * 1000); // 30 minutos
    </script>
</body>
</html>
